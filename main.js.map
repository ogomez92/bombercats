{"version":3,"sources":["utilities.js","keycodes.js","input.js","soundObject.js","scrollingText.js","strings.js","tts.js","menuItem.js","menu.js","numberSpeaker.js","timer.js","game.js","main.js"],"names":["GameUtils","progressPan","current","max","progressPitch","min","minPitch","maxPitch","progressVolume","minVolume","maxVolume","getProportion","distance3D","x1","y1","z1","x2","y2","z2","Math","sqrt","distance","jx","jy","kx","ky","calculateAngle","angle","atan2","PI","isCollide3D","a","b","x","width","y","height","z","depth","randomInt","floor","random","getRandomArbitrary","sleep","ms","Promise","resolve","setTimeout","percent","int1","int2","percentOf","average","arr","startIndex","len","length","val","i","averageInt","neg","num","numericSort","shuffle","j","objSize","obj","size","key","hasOwnProperty","utils","KeyEvent","DOM_VK_CANCEL","DOM_VK_HELP","DOM_VK_BACK_SPACE","DOM_VK_TAB","DOM_VK_CLEAR","DOM_VK_RETURN","DOM_VK_ENTER","DOM_VK_SHIFT","DOM_VK_CONTROL","DOM_VK_ALT","DOM_VK_PAUSE","DOM_VK_CAPS_LOCK","DOM_VK_ESCAPE","DOM_VK_SPACE","DOM_VK_PAGE_UP","DOM_VK_PAGE_DOWN","DOM_VK_END","DOM_VK_HOME","DOM_VK_LEFT","DOM_VK_UP","DOM_VK_RIGHT","DOM_VK_DOWN","DOM_VK_PRINTSCREEN","DOM_VK_INSERT","DOM_VK_DELETE","DOM_VK_0","DOM_VK_1","DOM_VK_2","DOM_VK_3","DOM_VK_4","DOM_VK_5","DOM_VK_6","DOM_VK_7","DOM_VK_8","DOM_VK_9","DOM_VK_SEMICOLON","DOM_VK_EQUALS","DOM_VK_A","DOM_VK_B","DOM_VK_C","DOM_VK_D","DOM_VK_E","DOM_VK_F","DOM_VK_G","DOM_VK_H","DOM_VK_I","DOM_VK_J","DOM_VK_K","DOM_VK_L","DOM_VK_M","DOM_VK_N","DOM_VK_O","DOM_VK_P","DOM_VK_Q","DOM_VK_R","DOM_VK_S","DOM_VK_T","DOM_VK_U","DOM_VK_V","DOM_VK_W","DOM_VK_X","DOM_VK_Y","DOM_VK_Z","DOM_VK_CONTEXT_MENU","DOM_VK_NUMPAD0","DOM_VK_NUMPAD1","DOM_VK_NUMPAD2","DOM_VK_NUMPAD3","DOM_VK_NUMPAD4","DOM_VK_NUMPAD5","DOM_VK_NUMPAD6","DOM_VK_NUMPAD7","DOM_VK_NUMPAD8","DOM_VK_NUMPAD9","DOM_VK_MULTIPLY","DOM_VK_ADD","DOM_VK_SEPARATOR","DOM_VK_SUBTRACT","DOM_VK_DECIMAL","DOM_VK_DIVIDE","DOM_VK_F1","DOM_VK_F2","DOM_VK_F3","DOM_VK_F4","DOM_VK_F5","DOM_VK_F6","DOM_VK_F7","DOM_VK_F8","DOM_VK_F9","DOM_VK_F10","DOM_VK_F11","DOM_VK_F12","DOM_VK_F13","DOM_VK_F14","DOM_VK_F15","DOM_VK_F16","DOM_VK_F17","DOM_VK_F18","DOM_VK_F19","DOM_VK_F20","DOM_VK_F21","DOM_VK_F22","DOM_VK_F23","DOM_VK_F24","DOM_VK_NUM_LOCK","DOM_VK_SCROLL_LOCK","DOM_VK_COMMA","DOM_VK_PERIOD","DOM_VK_SLASH","DOM_VK_BACK_QUOTE","DOM_VK_OPEN_BRACKET","DOM_VK_BACK_SLASH","DOM_VK_CLOSE_BRACKET","DOM_VK_QUOTE","DOM_VK_META","EventEmitter","require","KeyboardInput","constructor","keyDown","justPressed","chars","justReleased","justPressedEventCallback","charEventCallback","init","that","document","addEventListener","event","handleKeyDown","handleKeyUp","handleChar","pause","isPaused","resume","which","emit","char","console","log","String","fromCharCode","destroy","isDown","isJustPressed","isJustReleased","keysDown","kd","forEach","v","push","getChars","keysPressed","splice","releaseAllKeys","keysReleased","playOnceTimer","panner","defaults","panningModel","maxDistance","sono","playInBackground","SoundObjectItem","file","callback","tag","stream","duckingFirstTime","fileName","sound","create","src","onComplete","doneLoading","timeout","checkProgress","loaded","Audio","data","playbackRate","pitch","loop","progress","clearTimeout","play","err","stop","unload","duck","time","oldVolume","volume","fade","unduck","pos","forcePlay","playSync","die","inp","evt","once","removeAllListeners","active","playing","pan","currentPan","effects","add","set","seek","currentTime","duration","position","SoundObject","sounds","Array","loadingQueue","queueCallback","loadedSounds","loadingSounds","loadedCallback","queue","queueLength","statusCallback","directory","extension","oneShots","debug","oneShotSound","setStatusCallback","findSound","findSoundIndex","resetQueuedInstance","found","returnObject","loadQueueSync","so","setQueueCallback","loadQueue","createSync","snd","enqueue","handleQueue","resetQueue","setCallback","isLoading","playOnce","on","noMore","filename","kill","destroyAll","undefined","runningText","ScrollingText","text","delimiter","splitText","split","currentLine","sndOpen","sndContinue","sndClose","getElementById","prom","res","handleKeys","readCurrentLine","advance","handleTap","action","str","substr","speak","removeEventListener","Strings","strings","selectVoice","mSelectVoice","mLang","newUpdate","mSapi","mReader","newRate","rating","mRate","K","Q","A","J","cspades","cdiamonds","cclubs","chearts","dq","lang","langs","mainmenu","mSelect","mBack","mStart","yes","no","ok","get","what","rep","i1","Number","replace","check","lng","app","remote","useWebTTS","TTS","webTTS","voices","speechController","ducking","synth","Speech","rate","interrupt","VK_CONTROL","splitSentences","then","catch","e","setLanguage","setRate","r","sr","accessibilitySupportEnabled","listeners","onstart","onend","onerror","innerHTML","para","createElement","appendChild","createTextNode","setWebTTS","tts","cancel","changeRate","speech","changeVoice","name","voiceArray","k","includes","setVoice","cb","silent","wl","input","selection","ducker","MenuTypes","NORMAL","SELECTOR","SLIDER","EDIT","AUDIO","MenuItem","id","type","select","AudioItem","SelectorItem","options","defaultOption","selectCallback","currentOption","increase","decrease","SliderItem","from","to","currentValue","increaseBy","minValue","maxValue","EditItem","defaultText","addChar","removeChar","substring","Menu","menuData","music","fadeTime","audio","isAudio","prependAudio","first","cursor","dir","sndKeyChar","sndKeyDelete","sndSliderLeft","sndSliderRight","sndBoundary","sndChoose","sndMove","sndSelector","sndWrap","hammer","Hammer","nextItem","sndName","previousItem","moveCallback","insertCharacter","shortcut","toLowerCase","removeCharacter","handleInput","destroySounds","off","runSync","reject","run","s","selected","handleSwipe","items","addItem","value","toReturn","musicDuration","fs","NumberSpeaker","ntw","word_list","has_number","current_index","prepend","append","include_and","the_number","english_words","convert","abs","unshift","and","speak_next","state","look_until","assembled_filename","existsSync","__dirname","speakWait","result","Game","lives","score","level","lastscore","lastdiff","lastlevel","safe","start","md","round","cats","rsc","oldround","csnd","alive","catrev","catsmirk","maxround","mode","gameLoop","speakstats","vo","opt","rcat","sl","cam","chosencat","gameID","version","ttsVoice","version2","ttsRate","setup","focus","fetch","mainMenu","o","startGame"],"mappings":"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","file":"main.js","sourceRoot":"js","sourcesContent":["'use strict';\r\nclass GameUtils {\r\n\tprogressPan(current, max) {\r\n\t\treturn ((current * 200 / max) - 100) / 100;\r\n\t}\r\n\r\n\tprogressPitch(current, min, max, minPitch, maxPitch) {\r\n\t\treturn (current / (min + max)) * (maxPitch - minPitch) + minPitch;\r\n\t}\r\n\r\n\tprogressVolume(current, min, max, minVolume, maxVolume) {\r\n\t\tif (current > max) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\treturn (current / (min + max)) * (maxVolume - minVolume) + minVolume;\r\n\t}\r\n\r\n\tgetProportion(current, min, max, minVolume, maxVolume) {\r\n\t\tif (current > max) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\treturn (current / (min + max)) * (maxVolume - minVolume) + minVolume;\r\n\t}\r\n\r\n\tdistance3D(x1, y1, z1, x2, y2, z2) {\r\n\t\treturn Math.sqrt((x2 - x1) * (x2 - x1) +\r\n\t\t\t\t(y2 - y1) * (y2 - y1) +\r\n\t\t\t\t(z2 - z1) * (z2 - z1));\r\n\t}\r\n\r\n\tdistance(jx, jy, kx, ky) {\r\n\t\t// Return Math.hypot(jx-kx, jy-ky)\r\n\t\treturn Math.sqrt(((jx - kx) * (jx - kx)) + ((jy - ky)) * (jy - ky));\r\n\t}\r\n\r\n\tcalculateAngle(x1, y1, x2, y2) {\r\n\t\tlet angle = Math.atan2((y2 - y1), (x2 - x1));\r\n\t\tangle = (angle >= 0) ? 0 : (2 * Math.PI) + angle;\r\n\t\treturn angle;\r\n\t\t// Return Math.atan2((y2 - y1),(x2 - x1));\r\n\t}\r\n\r\n\tisCollide3D(a, b) {\r\n\t\treturn (a.x <= (b.x + b.width) && (a.x + a.width) >= b.x) && (a.y <= (b.y + b.height) && (a.y + a.height) >= b.y) && (a.z <= (b.z + b.depth) && (a.z + a.depth) >= b.z);\r\n\t}\r\n\r\n\trandomInt(min, max) {\r\n\t\treturn Math.floor(Math.random() * (max - min + 1)) + min;\r\n\t}\r\n\r\n\tgetRandomArbitrary(min, max) {\r\n\t\treturn Math.random() * (max - min) + min;\r\n\t}\r\n\r\n\tsleep(ms) {\r\n\t\treturn new Promise(resolve => setTimeout(resolve, ms));\r\n\t}\r\n\r\n\tpercent(int1, int2) {\r\n\t\treturn int1 * 100 / int2;\r\n\t}\r\n\r\n\tpercentOf(int1, int2) {\r\n\t\treturn int2 * int1 / 100;\r\n\t}\r\n\r\n\taverage(arr, startIndex = 0) {\r\n\t\tconst len = arr.length;\r\n\t\tlet val = 0;\r\n\t\tlet average = 0;\r\n\t\tif (arr.length < startIndex) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tfor (let i = startIndex; i < arr.length; i++) {\r\n\t\t\tval += arr[i];\r\n\t\t}\r\n\t\taverage = val / (len - startIndex);\r\n\t\treturn average;\r\n\t}\r\n\r\n\taverageInt(arr, startIndex = 0) {\r\n\t\tconst len = arr.length;\r\n\t\tlet val = 0;\r\n\t\tlet average = 0;\r\n\t\tif (arr.length < startIndex) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tfor (let i = startIndex; i < arr.length; i++) {\r\n\t\t\tval += arr[i];\r\n\t\t}\r\n\t\taverage = val / (len - startIndex);\r\n\t\treturn Math.floor(average);\r\n\t}\r\n\r\n\tneg(num) {\r\n\t\treturn (num >= 0 ? (num == 0 ? 0 : 1) : -1);\r\n\t}\r\n\r\n\tnumericSort(a, b) {\r\n\t\treturn (a < b ? -1 : (a == b ? 0 : 1));\r\n\t}\r\n\r\n\tshuffle(a) {\r\n\t\tfor (let i = a.length - 1; i > 0; i--) {\r\n\t\t\tconst j = Math.floor(Math.random() * (i + 1));\r\n\t\t\t[a[i], a[j]] = [a[j], a[i]];\r\n\t\t}\r\n\t\treturn a;\r\n\t}\r\n\r\n\tobjSize(obj) {\r\n\t\tlet size = 0;\r\n\r\n\t\tlet key;\r\n\t\tfor (key in obj) {\r\n\t\t\tif (obj.hasOwnProperty(key)) {\r\n\t\t\t\tsize++;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn size;\r\n\t}\r\n}\r\nexport var utils = new GameUtils();\r\n","\r\n'use strict';\r\nconst KeyEvent = {\r\nDOM_VK_CANCEL: 3,\r\n\t       DOM_VK_HELP: 6,\r\n\t       DOM_VK_BACK_SPACE: 8,\r\n\t       DOM_VK_TAB: 9,\r\n\t       DOM_VK_CLEAR: 12,\r\n\t       DOM_VK_RETURN: 13,\r\n\t       DOM_VK_ENTER: 14,\r\n\t       DOM_VK_SHIFT: 16,\r\n\t       DOM_VK_CONTROL: 17,\r\n\t       DOM_VK_ALT: 18,\r\n\t       DOM_VK_PAUSE: 19,\r\n\t       DOM_VK_CAPS_LOCK: 20,\r\n\t       DOM_VK_ESCAPE: 27,\r\n\t       DOM_VK_SPACE: 32,\r\n\t       DOM_VK_PAGE_UP: 33,\r\n\t       DOM_VK_PAGE_DOWN: 34,\r\n\t       DOM_VK_END: 35,\r\n\t       DOM_VK_HOME: 36,\r\n\t       DOM_VK_LEFT: 37,\r\n\t       DOM_VK_UP: 38,\r\n\t       DOM_VK_RIGHT: 39,\r\n\t       DOM_VK_DOWN: 40,\r\n\t       DOM_VK_PRINTSCREEN: 44,\r\n\t       DOM_VK_INSERT: 45,\r\n\t       DOM_VK_DELETE: 46,\r\n\t       DOM_VK_0: 48,\r\n\t       DOM_VK_1: 49,\r\n\t       DOM_VK_2: 50,\r\n\t       DOM_VK_3: 51,\r\n\t       DOM_VK_4: 52,\r\n\t       DOM_VK_5: 53,\r\n\t       DOM_VK_6: 54,\r\n\t       DOM_VK_7: 55,\r\n\t       DOM_VK_8: 56,\r\n\t       DOM_VK_9: 57,\r\n\t       DOM_VK_SEMICOLON: 59,\r\n\t       DOM_VK_EQUALS: 61,\r\n\t       DOM_VK_A: 65,\r\n\t       DOM_VK_B: 66,\r\n\t       DOM_VK_C: 67,\r\n\t       DOM_VK_D: 68,\r\n\t       DOM_VK_E: 69,\r\n\t       DOM_VK_F: 70,\r\n\t       DOM_VK_G: 71,\r\n\t       DOM_VK_H: 72,\r\n\t       DOM_VK_I: 73,\r\n\t       DOM_VK_J: 74,\r\n\t       DOM_VK_K: 75,\r\n\t       DOM_VK_L: 76,\r\n\t       DOM_VK_M: 77,\r\n\t       DOM_VK_N: 78,\r\n\t       DOM_VK_O: 79,\r\n\t       DOM_VK_P: 80,\r\n\t       DOM_VK_Q: 81,\r\n\t       DOM_VK_R: 82,\r\n\t       DOM_VK_S: 83,\r\n\t       DOM_VK_T: 84,\r\n\t       DOM_VK_U: 85,\r\n\t       DOM_VK_V: 86,\r\n\t       DOM_VK_W: 87,\r\n\t       DOM_VK_X: 88,\r\n\t       DOM_VK_Y: 89,\r\n\t       DOM_VK_Z: 90,\r\n\t       DOM_VK_CONTEXT_MENU: 93,\r\n\t       DOM_VK_NUMPAD0: 96,\r\n\t       DOM_VK_NUMPAD1: 97,\r\n\t       DOM_VK_NUMPAD2: 98,\r\n\t       DOM_VK_NUMPAD3: 99,\r\n\t       DOM_VK_NUMPAD4: 100,\r\n\t       DOM_VK_NUMPAD5: 101,\r\n\t       DOM_VK_NUMPAD6: 102,\r\n\t       DOM_VK_NUMPAD7: 103,\r\n\t       DOM_VK_NUMPAD8: 104,\r\n\t       DOM_VK_NUMPAD9: 105,\r\n\t       DOM_VK_MULTIPLY: 106,\r\n\t       DOM_VK_ADD: 107,\r\n\t       DOM_VK_SEPARATOR: 108,\r\n\t       DOM_VK_SUBTRACT: 109,\r\n\t       DOM_VK_DECIMAL: 110,\r\n\t       DOM_VK_DIVIDE: 111,\r\n\t       DOM_VK_F1: 112,\r\n\t       DOM_VK_F2: 113,\r\n\t       DOM_VK_F3: 114,\r\n\t       DOM_VK_F4: 115,\r\n\t       DOM_VK_F5: 116,\r\n\t       DOM_VK_F6: 117,\r\n\t       DOM_VK_F7: 118,\r\n\t       DOM_VK_F8: 119,\r\n\t       DOM_VK_F9: 120,\r\n\t       DOM_VK_F10: 121,\r\n\t       DOM_VK_F11: 122,\r\n\t       DOM_VK_F12: 123,\r\n\t       DOM_VK_F13: 124,\r\n\t       DOM_VK_F14: 125,\r\n\t       DOM_VK_F15: 126,\r\n\t       DOM_VK_F16: 127,\r\n\t       DOM_VK_F17: 128,\r\n\t       DOM_VK_F18: 129,\r\n\t       DOM_VK_F19: 130,\r\n\t       DOM_VK_F20: 131,\r\n\t       DOM_VK_F21: 132,\r\n\t       DOM_VK_F22: 133,\r\n\t       DOM_VK_F23: 134,\r\n\t       DOM_VK_F24: 135,\r\n\t       DOM_VK_NUM_LOCK: 144,\r\n\t       DOM_VK_SCROLL_LOCK: 145,\r\n\t       DOM_VK_COMMA: 188,\r\n\t       DOM_VK_PERIOD: 190,\r\n\t       DOM_VK_SLASH: 191,\r\n\t       DOM_VK_BACK_QUOTE: 192,\r\n\t       DOM_VK_OPEN_BRACKET: 219,\r\n\t       DOM_VK_BACK_SLASH: 220,\r\n\t       DOM_VK_CLOSE_BRACKET: 221,\r\n\t       DOM_VK_QUOTE: 222,\r\n\t       DOM_VK_META: 224\r\n};\r\nexport {KeyEvent};\r\n","import $ from 'jquery';\r\nconst EventEmitter = require('events');\r\n'use strict';\r\nclass KeyboardInput extends EventEmitter {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.keyDown = [];\r\n\t\tthis.justPressed = [];\r\n\t\tthis.chars = [];\r\n\t\tthis.justReleased = [];\r\n\t\tthis.justPressedEventCallback = null;\r\n\t\tthis.charEventCallback = null;\r\n\t}\r\n\r\n\tinit() {\r\n\t\tconst that = this;\r\n\t\t// \t\t$(document).keydown(function(event) { that.handleKeyDown(event); });\r\n\t\t// \t\t$(document).keyup(function(event) { that.handleKeyUp(event); });\r\n\t\tdocument.addEventListener('keydown', event => {\r\n\t\t\tthat.handleKeyDown(event);\r\n\t\t});\r\n\t\tdocument.addEventListener('keyup', event => {\r\n\t\t\tthat.handleKeyUp(event);\r\n\t\t});\r\n\t\tdocument.addEventListener('keypress', event => {\r\n\t\t\tthat.handleChar(event);\r\n\t\t});\r\n\t}\r\n\tpause() {\r\n\t\tthis.isPaused = true;\r\n\t}\r\n\tresume() {\r\n\t\tthis.isPaused = false;\r\n\t}\r\n\thandleKeyDown(event) {\r\n\t\tif (this.keyDown[event.which] != true || typeof this.keyDown[event.which] === 'undefined') {\r\n\t\t\tthis.keyDown[event.which] = true;\r\n\t\t\tthis.justPressed[event.which] = true;\r\n\t\t\tthis.emit(event.which);\r\n\t\t\tthis.justReleased[event.which] = false;\r\n\t\t\tif (typeof this.justPressedEventCallback !== 'undefined' && this.justPressedEventCallback != null) {\r\n\t\t\t\tthis.justPressedEventCallback(event.which);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\thandleChar(char) {\r\n\t\tconsole.log(\"char handled\", char)\r\n\t\tif (char.which < 48 || char.which > 122) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (String.fromCharCode(char.which) != '') {\r\n\t\t\tthis.chars += String.fromCharCode(char.which);\r\n\t\t\tthis.emit(\"chr\" + String.fromCharCode(char.which));\r\n\t\t\tif (typeof this.charEventCallback !== 'undefined' && this.charEventCallback != null) {\r\n\t\t\t\tthis.charEventCallback(String.fromCharCode(char.which));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\thandleKeyUp(event) {\r\n\t\tif (this.keyDown[event.which] == true) {\r\n\t\t\tthis.keyDown[event.which] = false;\r\n\t\t\tthis.justPressed[event.which] = false;\r\n\t\t\tthis.justReleased[event.which] = true;\r\n\t\t\tthis.emit(\"!\" + event.which);\r\n\t\t}\r\n\t\tthis.chars = '';\r\n\t}\r\n\tdestroy() {\r\n\t\tthis.charEventCallback = null;\r\n\t\tthis.justPressedEventCallback = null;\r\n\t}\r\n\tisDown(event) {\r\n\t\tif (this.isPaused) return false;\r\n\t\treturn this.keyDown[event];\r\n\t}\r\n\r\n\tisJustPressed(event) {\r\n\t\tif (this.isPaused) return false;\r\n\t\tif (this.justPressed[event] == true) {\r\n\t\t\tthis.justPressed[event] = false;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tisJustReleased(event) {\r\n\t\tif (this.justReleased[event]) {\r\n\t\t\tthis.justReleased[event] = false;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tkeysDown() {\r\n\t\tconst kd = [];\r\n\t\tthis.keyDown.forEach((v, i) => {\r\n\t\t\tif (v) {\r\n\t\t\t\tkd.push(i);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn kd;\r\n\t}\r\n\r\n\tgetChars() {\r\n\t\tconst kd = this.chars;\r\n\t\tthis.chars = '';\r\n\t\treturn kd;\r\n\t}\r\n\r\n\tkeysPressed() {\r\n\t\tconst kd = [];\r\n\t\tthis.justPressed.forEach((v, i) => {\r\n\t\t\tif (v) {\r\n\t\t\t\tkd.push(i);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.justPressed.splice();\r\n\t\treturn kd;\r\n\t}\r\n\r\n\treleaseAllKeys() {\r\n\r\n\t}\r\n\r\n\tkeysReleased() {\r\n\t\tconst kd = [];\r\n\t\tthis.justReleased.forEach((v, i) => {\r\n\t\t\tif (v) {\r\n\t\t\t\tkd.push(i);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.justReleased.splice();\r\n\t\treturn kd;\r\n\t}\r\n}\r\n\r\nexport { KeyboardInput };\r\n","import \"babel-polyfill\";\r\nimport { report } from './main';\r\nimport { speech } from './tts';\r\nimport panner from 'sono/effects/panner';\r\nconst EventEmitter = require('events');\r\nimport sono from 'sono';\r\nimport { KeyboardInput } from './input';\r\nimport { KeyEvent } from './keycodes';\r\nimport { utils } from './utilities';\r\npanner.defaults = {\r\n\tpanningModel: 'HRTF',\r\n\tmaxDistance: 50,\r\n};\r\nsono.playInBackground = true;\r\nvar playOnceTimer;\r\nclass SoundObjectItem extends EventEmitter {\r\n\tconstructor(file, callback = 0, tag = 0, stream = false) {\r\n\t\tsuper();\r\n\t\tthis.duckingFirstTime = true;\r\n\t\tthis.stream = stream;\r\n\t\tthis.panner = null;\r\n\t\tthis.fileName = file;\r\n\t\tif (typeof file == \"string\") {\r\n\t\t\tif (!stream) {\r\n\t\t\t\tthis.sound = sono.create({\r\n\t\t\t\t\tsrc: file,\r\n\t\t\t\t\tonComplete: () => { this.doneLoading(); }\r\n\t\t\t\t});\r\n\t\t\t\tthis.timeout = setTimeout(() => { this.checkProgress(); }, 2000);\r\n\t\t\t\tthis.loaded = false;\r\n\t\t\t\tthis.callback = callback;\r\n\t\t\t\tthis.tag = tag;\r\n\t\t\t}\r\n\t\t\tif (stream) {\r\n\t\t\t\tthis.loaded = true;\r\n\t\t\t\tthis.callback = callback;\r\n\t\t\t\tthis.tag = tag;\r\n\t\t\t\tthis.sound = sono.create(new Audio(file));\r\n\t\t\t\tthis.doneLoading();\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (typeof file == \"object\") {\r\n\t\t\tthis.sound = sono.create(\"\");\r\n\t\t\tthis.sound.data = file;\r\n\t\t\tthis.loaded = false;\r\n\t\t\tthis.callback = callback;\r\n\t\t\tthis.tag = tag;\r\n\t\t\tthis.doneLoading();\r\n\t\t}\r\n\r\n\r\n\t}\r\n\r\n\tget playbackRate() {\r\n\t\treturn this.sound.playbackRate\r\n\t}\r\n\r\n\tset playbackRate(v) {\r\n\t\treturn this.sound.playbackRate = v;\r\n\t}\r\n\tget pitch() {\r\n\t\treturn this.sound.playbackRate\r\n\t}\r\n\r\n\tset pitch(v) {\r\n\t\treturn this.sound.playbackRate = v;\r\n\t}\r\n\r\n\tset loop(v) {\r\n\t\tthis.sound.loop = v;\r\n\t}\r\n\r\n\tcheckProgress() {\r\n\t\tif (this.stream) return;\r\n\t\tif (this.sound.progress == 0) {\r\n\t\t\tthis.sound.destroy();\r\n\t\t\tthis.sound = sono.create({ src: this.fileName, onComplete: () => { this.doneLoading(); } }, this.stream);\r\n\t\t}\r\n\r\n\t\tif (this.sound.progress == 1) {\r\n\t\t\tthis.doneLoading();\r\n\t\t} else {\r\n\t\t\tthis.timeout = setTimeout(() => { this.checkProgress(); }, 500);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tdoneLoading() {\r\n\t\tif (!this.stream) clearTimeout(this.timeout);\r\n\t\tthis.loaded = true;\r\n\t\tif (this.callback != 0) {\r\n\t\t\tthis.callback();\r\n\t\t}\r\n\t}\r\n\tplay() {\r\n\t\t//sometimes, html element sounds complain about having a different connection, so wrap it in a try catch block.\r\n\t\ttry {\r\n\t\t\tthis.sound.play();\r\n\t\t} catch (err) {\r\n\t\t\t//report(err);\r\n\t\t\t//recreate the sound and replay\r\n\t\t\tif (this.stream) this.sound = sono.create(new Audio(this.fileName));\r\n\t\t\tif (!this.stream) this.sound = sono.create({\r\n\t\t\t\tsrc: this.fileName,\r\n\t\t\t\tonComplete: () => { this.doneLoading(); }\r\n\t\t\t});\r\n\t\t\tthis.sound.play();\r\n\t\t}\r\n\t}\r\n\tstop() {\r\n\t\tthis.sound.stop();\r\n\r\n\t}\r\n\tpause() {\r\n\t\tthis.sound.pause();\r\n\t}\r\n\tresume() {\r\n\t\tthis.sound.resume();\r\n\t}\r\n\tdestroy() {\r\n\t\ttry {\r\n\r\n\t\t\tthis.sound.destroy();\r\n\t\t} catch (err) {\r\n\r\n\t\t}\r\n\t}\r\n\tunload() { this.sound.destroy(); }\r\n\tduck(time) {\r\n\t\tif (this.duckingFirstTime) this.oldVolume = this.volume;\r\n\t\tthis.duckingFirstTime = false;\r\n\t\tthis.sound.fade(0.3, 0.15);\r\n\t}\r\n\tunduck(time) {\r\n\t\tthis.sound.fade(this.oldVolume, 0.15);\r\n\t}\r\n\tasync fade(time) {\r\n\t\tthis.sound.fade(0, time / 1000);\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.sound.stop();\r\n\t\t\t\tresolve('ok');\r\n\t\t\t}, time);// End\r\n\t\t});// Promise\r\n\r\n\t}\r\n\r\n\tpos(x, y, z) {\r\n\r\n\t}\r\n\r\n\tforcePlay() {\r\n\t\tthis.sound.stop();\r\n\t\tthis.sound.play();\r\n\t}\r\n\tasync playSync(die = false) {\r\n\t\tconst inp = new KeyboardInput();\r\n\t\tinp.init();\r\n\t\tthis.sound.play();\r\n\r\n\t\tinp.justPressedEventCallback = (evt => {\r\n\t\t\tif (evt == KeyEvent.DOM_VK_Q || evt == KeyEvent.DOM_VK_X || evt == KeyEvent.DOM_VK_ESCAPE || evt == KeyEvent.DOM_VK_SPACE || evt == KeyEvent.DOM_VK_ENTER) {\r\n\t\t\t\tthis.sound.stop();\r\n\t\t\t\tinp.justPressedEventCallback = null;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tthis.sound.once('ended', () => {\r\n\t\t\t\tthis.sound.removeAllListeners();\r\n\t\t\t\tif (die) this.sound.destroy();\r\n\t\t\t\tresolve('ok');\r\n\t\t\t\tinp.justPressedEventCallback = null;\r\n\t\t\t});// End\r\n\t\t\tthis.sound.once('stop', () => {\r\n\t\t\t\tthis.sound.removeAllListeners();\r\n\t\t\t\tif (die) this.sound.destroy();\r\n\t\t\t\tresolve('ok');\r\n\t\t\t\tinp.justPressedEventCallback = null;\r\n\t\t\t});// Stop\r\n\t\t});// Promise\r\n\t}\r\n\r\n\tget active() {\r\n\t\tif (!this.sound.loaded) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (this.sound.progress < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (this.sound.loaded) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t}\r\n\tget playing() {\r\n\t\treturn this.sound.playing;\r\n\t}\r\n\r\n\tget pan() {\r\n\t\tif (!this.panner) {\r\n\t\t\tthis.panner = this.sound.effects.add(panner());\r\n\t\t\tthis.currentPan = 0;\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\treturn this.currentPan;\r\n\t}\r\n\r\n\tset pan(v) {\r\n\t\tif (!this.panner) {\r\n\t\t\tthis.panner = this.sound.effects.add(panner());\r\n\t\t}\r\n\t\tthis.currentPan = v;\r\n\t\treturn this.panner.set(v);\r\n\t}\r\n\tget volume() {\r\n\t\treturn this.sound.volume;\r\n\t}\r\n\tset volume(v) {\r\n\t\tthis.sound.volume = v;\r\n\t}\r\n\r\n\tseek(time) {\r\n\t\treturn this.sound.seek(time);\r\n\t}\r\n\r\n\tget currentTime() {\r\n\t\treturn this.sound.currentTime;\r\n\t}\r\n\r\n\tget duration() {\r\n\t\treturn this.sound.duration *1000;\r\n\t}\r\n\r\n\tget position() {\r\n\t\treturn this.sound.currentTime;\r\n\t}\r\n\r\n\tset currentTime(v) {\r\n\t\treturn this.sound.seek(v);\r\n\t}\r\n\r\n}\r\n\r\nclass SoundObject {\r\n\tconstructor() {\r\n\t\tthis.sounds = new Array();\r\n\t\tthis.loadingQueue = false;\r\n\t\tthis.queueCallback = 0;\r\n\t\tthis.loadedSounds = 0;\r\n\t\tthis.loadingSounds = 0;\r\n\t\tthis.loadedCallback = 0;\r\n\t\tthis.queue = new Array();\r\n\t\tthis.queueLength = 0;\r\n\t\tthis.statusCallback = null;\r\n\t\tthis.directory = \"./sounds/\";\r\n\t\tthis.extension = \".ogg\";\r\n\t\tthis.oneShots = new Array();\r\n\t\tthis.debug = false;\r\n\r\n\r\n\t\tthis.oneShotSound = null;\r\n\t}\r\n\tsetStatusCallback(callback) {\r\n\t\tthis.statusCallback = callback;\r\n\t}\r\n\tfindSound(file) {\r\n\t\tfor (let i = 0; i < this.sounds.length; i++) {\r\n\t\t\tif (this.sounds[i].fileName == file && this.sounds[i].loaded) {\r\n\t\t\t\treturn this.sounds[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1;\r\n\t}\r\n\tfindSoundIndex(file) {\r\n\t\tfor (const i in this.sounds) {\r\n\t\t\tif (this.sounds[i].fileName == file) {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn -1;\r\n\t}\r\n\r\n\r\n\tresetQueuedInstance() {\r\n\t\tfor (let i = 0; i < this.sounds.length; i++) {\r\n\t\t\tif (typeof this.sounds[i] != \"undefined\") {\r\n\t\t\t\tif (this.sounds[i].tag == 1) {\r\n\t\t\t\t\tthis.sounds[i].sound.destroy();\r\n\t\t\t\t\tthis.sounds.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.loadingQueue = false;\r\n\t\tthis.queueCallback = 0;\r\n\t\tthis.loadedSounds = 0;\r\n\t\tthis.loadingSounds = 0;\r\n\t\tthis.loadedCallback = 0;\r\n\t\tthis.queue = new Array();\r\n\t\tthis.queueLength = 0;\r\n\t\tthis.statusCallback = null;\r\n\t}\r\n\r\n\r\n\r\n\tcreate(file, stream = false) {\r\n\t\tfile = this.directory + file + this.extension;\r\n\t\tlet found = -1;\r\n\t\tfound = this.findSound(file);\r\n\t\tlet returnObject = null;\r\n\t\tif (found == -1 || found.sound.data == null) {\r\n\t\t\treturnObject = new SoundObjectItem(file, () => { if (!stream) this.doneLoading(); }, 0, stream);\r\n\t\t\tthis.sounds.push(returnObject);\r\n\t\t} else {\r\n\t\t\treturnObject = new SoundObjectItem(found.sound.data, () => { if (!stream) this.doneLoading(); }, 0, stream);\r\n\t\t\treturnObject.fileName = found.fileName;\r\n\t\t}\r\n\t\treturnObject.fileName = file; //otherwise html element fileNames get fucked up.\r\n\t\treturn returnObject;\r\n\t}\r\n\tasync loadQueueSync() {\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tso.setQueueCallback(() => {\r\n\t\t\t\tresolve(true);\r\n\t\t\t});\r\n\t\t\tso.loadQueue();\r\n\t\t});\r\n\t}\r\n\tasync createSync(file, stream = false) {\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tfile = this.directory + file + this.extension;\r\n\t\t\tlet found = -1;\r\n\t\t\tfound = this.findSound(file);\r\n\t\t\tlet returnObject = null;\r\n\t\t\tif (found == -1 || found.sound.data == null) {\r\n\t\t\t\treturnObject = new SoundObjectItem(file, () => { if (!stream) this.doneLoading(); }, 0, stream);\r\n\t\t\t\tthis.sounds.push(returnObject);\r\n\t\t\t\tif (stream) resolve(returnObject);\r\n\t\t\t} else {\r\n\t\t\t\treturnObject = new SoundObjectItem(found.sound.data, () => { if (!stream) this.doneLoading(); }, 0, stream);\r\n\t\t\t\tresolve(returnObject);\r\n\t\t\t}\r\n\t\t\treturnObject.fileName = file; //otherwise html element fileNames get fucked up.\r\n\t\t\tif (stream) resolve(returnObject);\r\n\t\t\tif (!stream) {\r\n\t\t\t\treturnObject.sound.once('loaded', () => {\r\n\t\t\t\t\tresolve(returnObject);\r\n\t\t\t\t\tthis.doneLoading();\r\n\t\t\t\t});// End\r\n\t\t\t}//stream\r\n\t\t});// Promise\r\n\t}\r\n\tasync playSync(file) {\r\n\t\tlet snd = await so.createSync(file);\r\n\t\tawait snd.playSync();\r\n\t\tsnd.destroy();\r\n\t}\r\n\r\n\tenqueue(file, stream = false) {\r\n\t\tfile = this.directory + file + this.extension;\r\n\t\tthis.queue.push({ file, stream });\r\n\t\tthis.queueLength = this.queue.length;\r\n\t}\r\n\r\n\tloadQueue() {\r\n\r\n\t\tthis.handleQueue();\r\n\t\tthis.loadingQueue = true;\r\n\r\n\t}\r\n\tsetQueueCallback(callback) {\r\n\t\tthis.queueCallback = callback;\r\n\t}\r\n\tresetQueue() {\r\n\t\tthis.queue = [];\r\n\t\tthis.loadingQueue = false;\r\n\t}\r\n\thandleQueue() {\r\n\t\tif (this.queue.length > 0) {\r\n\t\t\tif (typeof this.statusCallback != \"undefined\" && this.statusCallback != null) {\r\n\t\t\t\tthis.statusCallback(1 - this.queue.length / this.queueLength);\r\n\t\t\t}\r\n\t\t\tif (this.findSound(this.queue[0].file) != -1) {\r\n\t\t\t\tthis.queue.splice(0, 1);\r\n\t\t\t\tthis.handleQueue();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet file = this.queue[0].file;\r\n\t\t\tlet stream = this.queue[0].stream;\r\n\t\t\tthis.queue.splice(0, 1);\r\n\t\t\tthis.sounds.push(new SoundObjectItem(file, () => { this.handleQueue(); }, 1, stream));\r\n\r\n\t\t} else {\r\n\t\t\tthis.loadingQueue = false;\r\n\t\t\tif (typeof this.queueCallback != \"undefined\" && this.queueCallback != 0) {\r\n\t\t\t\tthis.queueCallback();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\tsetCallback(callback) {\r\n\t\tthis.loadedCallback = callback;\r\n\t}\r\n\tdoneLoading() {\r\n\t\tlet result = this.isLoading();\r\n\r\n\t\tif (result == 1) {\r\n\r\n\t\t\tif (typeof this.loadedCallback != \"undefined\" && this.loadedCallback != 0 && this.loadedCallback != null) {\r\n\t\t\t\tthis.loadedCallback();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tisLoading() {\r\n\t\tlet loading = 0;\r\n\t\tthis.loadedSounds = 0;\r\n\t\tthis.loadingSounds = 0;\r\n\t\tlet stillLoading = new Array();\r\n\t\tfor (let i = 0; i < this.sounds.length; i++) {\r\n\t\t\tif (typeof this.sounds[i] != \"undefined\") {\r\n\t\t\t\tif (this.sounds[i].loaded == false) {\r\n\t\t\t\t\tthis.loadingSounds++;\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.loadedSounds++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this.loadedSounds / this.sounds.length;\r\n\t}\r\n\r\n\tplayOnce(file) {\r\n\t\tthis.oneShotSound = this.create(file).sound;\r\n\t\tthis.oneShotSound.stop();\r\n\t\tthis.oneShotSound.play();\r\n\t\tthis.oneShotSound.on(\"ended\", () => {\r\n\t\t\tif (this.oneShotSound.playing == false) this.oneShotSound.destroy();\r\n\t\t});\r\n\r\n\t}\r\n\tdestroy(file, callback = 0) {\r\n\t\tlet noMore = false;\r\n\t\tconst filename = this.directory + file + this.extension;\r\n\t\twhile (!noMore) {\r\n\t\t\tconst found = this.findSoundIndex(filename);\r\n\t\t\tif (found == -1) {\r\n\t\t\t\tnoMore = true;\r\n\t\t\t} else {\r\n\t\t\t\tthis.sounds[found].sound.unload();\r\n\t\t\t\tthis.sounds.splice(found, 1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (callback != 0) {\r\n\t\t\tcallback();\r\n\t\t}\r\n\t}\r\n\r\n\tkill(callback = 0) {\r\n\t\twhile (this.sounds.length > 0) {\r\n\t\t\tthis.sounds.splice(0, 1);\r\n\t\t}\r\n\r\n\t\tsono.destroyAll();\r\n\t\tif (callback != 0) {\r\n\t\t\tcallback();\r\n\t\t}\r\n\t}\r\n\r\n}\r\nexport let so = new SoundObject();","'use strict';\r\nimport $ from 'jquery';\r\nimport {KeyEvent} from './keycodes';\r\nimport {so} from './soundObject';\r\nimport {speech} from './tts';\r\n\r\nif (runningText == undefined) {\r\n\tvar runningText = 0;\r\n}\r\nclass ScrollingText {\r\n\tconstructor(text, delimiter = '\\n', callback = 0) {\r\n\t\tthis.callback = callback;\r\n\r\n\t\tthis.text = text;\r\n\t\tthis.delimiter = delimiter;\r\n\t\tthis.splitText = this.text.split(delimiter);\r\n\t\tthis.currentLine = 0;\r\n\t\tthis.sndOpen = so.create('ui/textOpen');\r\n\t\tthis.sndContinue = so.create('ui/textScroll');\r\n\t\tthis.sndClose = so.create('ui/textClose');\r\n\t\tconst id = document.getElementById('touchArea');\r\n\t\t// This.hammer = new Hammer(id);\r\n\t\tthis.init();\r\n\t\tif (this.callback == 0) {\r\n\t\t\treturn this.prom = new Promise(resolve => {\r\n\t\t\t\t\tthis.res = resolve;\r\n\t\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tinit() {\r\n\t\tconst that = this;\r\n\t\trunningText = this;\r\n\t\tdocument.addEventListener('keydown', this.handleKeys);\r\n\t\t// This.hammer.on(\"swipeleft swiperight\", function() { that.handleTap(0); });\r\n\t\t// this.hammer.on(\"tap\", function() { that.handleTap(1); });\r\n\t\tthis.sndOpen.play();\r\n\t\tthis.currentLine = 0;\r\n\t\tthis.readCurrentLine();\r\n\t}\r\n\r\n\thandleKeys(event) {\r\n\t\tswitch (event.which) {\r\n\t\t\tcase KeyEvent.DOM_VK_UP:\r\n\t\t\tcase KeyEvent.DOM_VK_DOWN:\r\n\t\t\tcase KeyEvent.DOM_VK_LEFT:\r\n\t\t\tcase KeyEvent.DOM_VK_RIGHT:\r\n\t\t\t\trunningText.readCurrentLine();\r\n\t\t\t\tbreak;\r\n\t\t\tcase KeyEvent.DOM_VK_RETURN:\r\n\t\t\t\trunningText.advance();\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\thandleTap(action) {\r\n\t\tif (action == 0) {\r\n\t\t\tthis.readCurrentLine();\r\n\t\t}\r\n\r\n\t\tif (action == 1) {\r\n\t\t\tthis.advance();\r\n\t\t}\r\n\t}\r\n\r\n\treadCurrentLine() {\r\n\t\tif (this.splitText[this.currentLine][0] == '!') {\r\n\t\t\tconst str = this.splitText[this.currentLine].substr(1);\r\n\t\t\tconst snd = so.create(str, true);\r\n\t\t\tsnd.play();\r\n\t\t\tsnd.sound.once('end', () => {\r\n\t\t\t\t\tthis.advance();\r\n\t\t\t\t\t});\r\n\t\t} else {\r\n\t\t\tspeech.speak(this.splitText[this.currentLine]);\r\n\t\t}\r\n\t}\r\n\r\n\tadvance() {\r\n\t\tif (this.currentLine < this.splitText.length - 1) {\r\n\t\t\tthis.currentLine++;\r\n\t\t\tthis.sndContinue.play();\r\n\t\t\tthis.readCurrentLine();\r\n\t\t} else {\r\n\t\t\tthis.sndClose.play();\r\n\t\t\tthis.sndClose.unload();\r\n\t\t\tthis.sndOpen.unload();\r\n\t\t\tthis.sndContinue.unload();\r\n\t\t\tdocument.removeEventListener('keydown', this.handleKeys);\r\n\t\t\t//\t\t\tThis.hammer.unload();\r\n\t\t\tif (this.callback != 0) {\r\n\t\t\t\tthis.callback();\r\n\t\t\t} else {\r\n\t\t\t\tthis.res();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nexport {ScrollingText, speech};\r\n","'use strict';\r\nimport {lang} from './main';\r\nimport {utils} from './utilities';\r\nimport {speech} from './tts';\r\nimport {ScrollingText} from './scrollingText';\r\n\r\nclass Strings {\r\n\tconstructor() {\r\n\t\tthis.strings = {};\r\n\t\tthis.strings[1] = {\r\n\t\t\t// New English\r\nselectVoice:\"%1 voices available, use the up and down arrows to select a voice, enter when you're done.\",\r\n\t    mSelectVoice:\"text to speech voice\",\r\n\t    mLang: 'Change language',\r\n\t    newUpdate: 'There is a new version available! You have version %1, version %2 is available.',\r\n\t    mSapi: 'Use text to speech for the game',\r\n\t    mReader: 'Use your screen reader for the game',\r\n\r\n\t    newRate: 'This is a text to speech rate test. Please press enter when done',\r\n\t    rating: 'Press right and left arrow keys to change the rate. Press enter when done',\r\n\t    mRate: 'Change speech rate',\r\n\r\n\t    K: 'king',\r\n\t    Q: 'queen',\r\n\t    A: 'ace',\r\n\t    J: 'jack',\r\n\t    cspades: 'spades',\r\n\t    cdiamonds: 'diamonds',\r\n\t    cclubs: 'clubs',\r\n\t    chearts: 'hearts',\r\n\t    dq: 'This is a game of risk. You will risk losing %1 beatcoins. Continue?',\r\n\t    lang: 'English',\r\n\t    langs: 'Select your language',\r\n\t    mainmenu: 'main menu: arrow keys to select options, page up and page down raise and lower the music volume. You can also use the first letter of an option to move to it',\r\n\t    mSelect: 'Please select',\r\n\t    mBack: 'go back',\r\n\t    mStart: 'Start Game',\r\n\t    yes: 'Yes',\r\n\t    no: 'no',\r\n\t    ok: 'ok',\r\n\t\t};\r\n\t\tthis.strings[2] = {\r\n\t\t\t// New Spanish\r\n\r\n\t\t};\r\n\t}\r\n\r\n\tget(what, rep = []) {\r\n\t\tlet str;\r\n\t\tif (typeof this.strings[lang][what] !== 'undefined') {\r\n\t\t\tstr = this.strings[lang][what];\r\n\t\t} else if (typeof this.strings[1][what] !== 'undefined') {\r\n\t\t\tstr = this.strings[1][what];\r\n\t\t} else {\r\n\t\t\treturn what;\r\n\t\t}\r\n\t\trep.forEach((v, i) => {\r\n\t\t\t\tconst i1 = Number(i) + 1;\r\n\t\t\t\tstr = str.replace('%' + i1, v);\r\n\t\t\t\t});\r\n\t\treturn str;\r\n\t}\r\n\r\n\tspeak(what, rep = []) {\r\n\t\tlet str;\r\n\t\tif (typeof this.strings[lang][what] !== 'undefined') {\r\n\t\t\tstr = this.strings[lang][what];\r\n\t\t} else if (typeof this.strings[1][what] !== 'undefined') {\r\n\t\t\tstr = this.strings[1][what];\r\n\t\t} else {\r\n\t\t\tspeech.speak(what);\r\n\t\t}\r\n\t\trep.forEach((v, i) => {\r\n\t\t\t\tconst i1 = Number(i) + 1;\r\n\t\t\t\tstr = str.replace('%' + i1, v);\r\n\t\t\t\t});\r\n\t\tspeech.speak(str);\r\n\t}\r\n\r\n\tasync check(lng) {\r\n\t\tconst len = utils.objSize(this.strings) - 2;\r\n\t\tfor (const i in this.strings[1]) {\r\n\t\t\tif (!this.strings[lng].hasOwnProperty(i)) {\r\n\t\t\t\tawait new ScrollingText(i + ': ' + this.strings[1][i]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nexport var strings = new Strings();\r\n","import \"babel-polyfill\";\r\nconst { app } = require('electron').remote;\r\nimport { report } from './main';\r\n\r\n'use strict';\r\n\r\nimport { strings } from './strings';\r\nimport { utils } from './utilities'\r\nimport { lang, ttsVoice, ttsRate } from './main';\r\nimport { KeyboardInput } from './input.js';\r\nimport { KeyEvent } from './keycodes';\r\nconst useWebTTS = true;\r\nimport Speech from 'speak-tts' // es6\r\nclass TTS {\r\n\tconstructor(webTTS = true) {\r\n\t\tthis.voices = []\r\n\t\tthis.speechController = new KeyboardInput();\r\n\t\tthis.speechController.init();\r\n\t\tthis.ducking = false;\r\n\t\tif (lang == 1) this.lang = \"en\";\r\n\t\tif (lang == 2) this.lang = \"es\";\r\n\t\tthis.webTTS = webTTS;\r\n\t\tthis.synth = new Speech()\r\n\t\tthis.rate = 2;\r\n\t\tthis.speechController.justPressedEventCallback = (key) => {\r\n\t\t\tif (this.interrupt) this.speak(\"\", false);\r\n\t\t\tif (key == KeyEvent.VK_CONTROL || key == KeyEvent.DOM_VK_ESCAPE) {\r\n\t\t\t\tthis.speak(\"\", false);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.synth.init({\r\n\t\t\tlang: this.lang,\r\n\t\t\trate: this.rate,\r\n\t\t\tsplitSentences: false,\r\n\t\t})\r\n\t\t\t.then((data) => {\r\n\t\t\t\tthis.voices = data.voices;\r\n\t\t\t}).catch(e => {\r\n\t\t\t\treport(e);\r\n\t\t\t})\r\n\t}\r\n\tsetLanguage(lang) {\r\n\t\ttry {\r\n\t\t\tif (lang == 1) this.lang = \"en\";\r\n\t\t\tif (lang == 2) this.lang = \"es\";\r\n\t\t\tthis.synth.setLanguage(this.lang)\r\n\t\t} catch (err) {\r\n\t\t\treport(err);\r\n\t\t}\r\n\t}\r\n\tsetRate(r) {\r\n\t\tlet newRate = r;\r\n\t\tif (r < 1) newRate == 1;\r\n\t\tif (r > 10) newRate = 10;\r\n\t\tthis.rate = newRate;\r\n\t\tthis.synth.setRate(newRate);\r\n\t}\r\n\tspeak(text, queue = false) {\r\n\t\tlet sr = app.accessibilitySupportEnabled;\r\n\r\n\t\tif (sr) this.webTTS = false;\r\n\t\tif (!sr) this.webTTS = true;\r\n\t\tif (this.webTTS) {\r\n\t\t\ttry {\r\n\t\t\t\tif (typeof text == \"number\") {\r\n\t\t\t\t\ttext = text + \".\";\r\n\t\t\t\t\t//we need this because some voices fail to process numbers. Why? Don't ask me.\r\n\t\t\t\t}\r\n\t\t\t\tthis.synth.speak({\r\n\t\t\t\t\ttext: text,\r\n\t\t\t\t\tqueue: queue,\r\n\t\t\t\t\tlisteners: {\r\n\t\t\t\t\t\tonstart: () => {\r\n\t\t\t\t\t\t\tthis.duck();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tonend: () => {\r\n\t\t\t\t\t\t\tthis.unduck();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tonerror: (err) => {\r\n\t\t\t\t\t\t\t//this.setVoice(null,true);\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t} catch {\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.duck();\r\n\t\t\tdocument.getElementById('speech').innerHTML = '';\r\n\t\t\tconst para = document.createElement('p');\r\n\t\t\tpara.appendChild(document.createTextNode(text));\r\n\t\t\tdocument.getElementById('speech').appendChild(para);\r\n\t\t}\r\n\t} // End speak()\r\n\r\n\tsetWebTTS(tts) {\r\n\t\tthis.webTTS = tts;\r\n\t}\r\n\r\n\tstop() {\r\n\t\tif (this.webTTS) {\r\n\t\t\tthis.synth.cancel();\r\n\t\t}\r\n\t}\r\n\tasync changeRate() {\r\n\t\tlet rate = speech.rate;\r\n\t\tconst inp = new KeyboardInput();\r\n\t\tinp.init();\r\n\t\tstrings.speak('rating');\r\n\t\twhile (!inp.isJustPressed(KeyEvent.DOM_VK_RETURN)) {\r\n\t\t\tawait utils.sleep(5);\r\n\t\t\tif (inp.isJustPressed(KeyEvent.DOM_VK_RIGHT)) {\r\n\t\t\t\trate += 0.25;\r\n\t\t\t\tif (rate > 10) rate = 10;\r\n\r\n\t\t\t\tspeech.setRate(rate)\r\n\t\t\t\tstrings.speak('newRate');\r\n\t\t\t}\r\n\t\t\tif (inp.isJustPressed(KeyEvent.DOM_VK_LEFT)) {\r\n\t\t\t\trate -= 0.25;\r\n\t\t\t\tif (rate < 1) rate = 1;\r\n\t\t\t\tspeech.setRate(rate)\r\n\t\t\t\tstrings.speak('newRate');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tchangeVoice(name) {\r\n\t\tlet voiceArray = []\r\n\t\tfor (var k in this.voices) {\r\n\t\t\tvoiceArray.push(this.voices[k].name)\r\n\t\t}\r\n\t\tif (voiceArray.includes(name)) {\r\n\t\t\tspeech.synth.setVoice(name);\r\n\t\t}\r\n\r\n\t}\r\n\tsetVoice(cb, silent = false) {\r\n\t\t//what language do we want?\r\n\t\tlet wl = \"en\";\r\n\t\tif (lang == 1) wl = \"en\";\r\n\t\tif (lang == 2) wl = \"es\";\r\n\t\tlet voiceArray = []\r\n\t\tfor (var k in this.voices) {\r\n\t\t\t//get the first part of the voice languages\r\n\t\t\tlet vl = this.voices[k].lang.split(\"-\")[0]\r\n\t\t\t//do we want this language?\r\n\t\t\tif (vl == wl) {\r\n\t\t\t\tvoiceArray.push(this.voices[k].name)\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!silent) speech.speak(strings.get(\"selectVoice\", [voiceArray.length]));\r\n\t\tlet input = new KeyboardInput()\r\n\t\tlet selection = -1;\r\n\t\tinput.init();\r\n\t\tif (!silent) {\r\n\t\t\tinput.justPressedEventCallback = ((key) => {\r\n\t\t\t\tif (key == KeyEvent.DOM_VK_DOWN) {\r\n\t\t\t\t\tselection++;\r\n\t\t\t\t\tif (selection >= voiceArray.length) selection = 0;\r\n\t\t\t\t}\r\n\t\t\t\tif (key == KeyEvent.DOM_VK_UP) {\r\n\t\t\t\t\tselection--;\r\n\t\t\t\t\tif (selection <= -1) selection = voiceArray.length - 1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (key != KeyEvent.DOM_VK_RETURN && (key == KeyEvent.DOM_VK_UP || key == KeyEvent.DOM_VK_DOWN)) { //dirty hack\r\n\t\t\t\t\tthis.synth.setVoice(voiceArray[selection]);\r\n\t\t\t\t\tspeech.speak(voiceArray[selection])\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t//it is enter\r\n\t\t\t\t\tif (selection != -1) { //don't crash if it's -1.\r\n\t\t\t\t\t\tinput.destroy();\r\n\t\t\t\t\t\tif (typeof cb !== \"undefined\") {\r\n\t\t\t\t\t\t\tcb(voiceArray[selection])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn voiceArray[selection]\r\n\t\t\t\t\t}\r\n\t\t\t\t}//enter action\r\n\t\t\t});//callback\r\n\t\t} //not silent\r\n\t\telse {\r\n\t\t\ttry {\r\n\t\t\t\tthis.synth.setVoice(voiceArray[0]);\r\n\t\t\t\treturn voiceArray[0];\r\n\t\t\t} catch (err) {\r\n\t\t\t\treport(err);\r\n\t\t\t\tthis.synth.setVoice(voiceArray[1]);\r\n\t\t\t\treturn voiceArray[1];\r\n\t\t\t} // catch block\r\n\t\t}//else\r\n\t}//function\r\n\tduck() {\r\n\t\tif (this.ducking) return;\r\n\t\tthis.ducking = true;\r\n\t\tif (typeof this.ducker !== \"undefined\") this.ducker.duck();\r\n\t}\r\n\tunduck() {\r\n\t\tthis.ducking = false;\r\n\t\tif (typeof this.ducker !== \"undefined\") this.ducker.unduck();\r\n\t}\r\n\r\n} // End class\r\nconst speech = new TTS(false);\r\n//if (process.platform == 'darwin') {\r\n//\tspeech.webTTS = true;\r\n//}\r\nexport { TTS, speech };\r\n","'use strict';\r\nimport {speech} from './tts';\r\nimport {so} from './soundObject';\r\nconst MenuTypes = {\r\n\tNORMAL: 0,\r\n\t\tSELECTOR: 1,\r\n\t\tSLIDER: 2,\r\n\t\tEDIT: 3,\r\n\t\tAUDIO: 4,\r\n};\r\nclass MenuItem {\r\n\tconstructor(id, name) {\r\n\t\tthis.name = name;\n\t\t\t\t\tthis.id = id;\r\n\t\t\tthis.type = MenuTypes.NORMAL;\r\n\t}\r\n\t\r\n\t\tspeak() {\r\n\t\t\tspeech.speak(this.name);\r\n\t\t}\r\n\t\r\n\t\tselect() {\r\n\t\t\treturn this.id;\r\n\t\t}\r\n}\r\nclass AudioItem extends MenuItem{\r\n\tconstructor(id, name) {\r\n\t\tsuper();\r\n\t\t\tthis.name = name;\r\n\t\t\tthis.type = MenuTypes.AUDIO;\r\n\t\t\tthis.id = id;\r\n\t\t\tthis.snd=so.create(this.name);\r\n\t}\r\n\t\r\n\t\tspeak() {\n\t\t\tthis.snd.stop();\r\n\t\t\t\tthis.snd.play();\r\n\t\t}\r\n\t\r\n\t\tselect() {\r\n\t\t\treturn this.id;\r\n\t\t}\r\n}\r\n\r\n\r\nclass SelectorItem extends MenuItem {\r\n\tconstructor(id, name, options, defaultOption = 0, selectCallback) {\r\n\t\tsuper();\r\n\t\t\tthis.id = id;\r\n\t\t\tthis.name = name;\r\n\t\t\tthis.options = options;\r\n\t\t\tthis.type = MenuTypes.SELECTOR;\r\n\t\t\tthis.currentOption = defaultOption;\r\n\t\t\tthis.selectCallback = selectCallback;\r\n\t}\r\n\t\r\n\t\tspeak() {\r\n\t\t\tspeech.speak(this.name + '. Selector. Set to ' + this.options[this.currentOption]);\r\n\t\t}\r\n\t\r\n\t\tincrease() {\r\n\t\t\tif (this.currentOption < this.options.length - 1) {\r\n\t\t\t\tthis.currentOption++;\r\n\t\t\t}\r\n\t\t\tspeech.speak(this.options[this.currentOption]);\r\n\t\t\t\tif (typeof this.selectCallback !== 'undefined') {\r\n\t\t\t\t\tthis.selectCallback(this.options[this.currentOption]);\r\n\t\t\t\t}\r\n\t\t}\r\n\t\r\n\t\tdecrease() {\r\n\t\t\tif (this.currentOption > 0) {\r\n\t\t\t\tthis.currentOption--;\r\n\t\t\t}\r\n\t\t\tspeech.speak(this.options[this.currentOption]);\r\n\t\t\t\tif (typeof this.selectCallback !== 'undefined') {\r\n\t\t\t\t\tthis.selectCallback(this.options[this.currentOption]);\r\n\t\t\t\t}\r\n\t\t}\r\n\t\r\n\t\tselect() {\r\n\t\t\treturn this.id;\r\n\t\t}\r\n}\r\n\r\nclass SliderItem extends MenuItem {\r\n\tconstructor(id, name, from, to, currentValue = 0,increaseBy=1) {\r\n\t\tsuper();\r\n\t\t\tthis.id = id;\r\n\t\t\tthis.name = name;\r\n\t\t\tthis.minValue = from;\r\n\t\t\tthis.maxValue = to;\r\n\t\t\tthis.currentValue = currentValue;\r\n\t\t\tthis.increaseBy=increaseBy;\r\n\t\t\tthis.type = MenuTypes.SLIDER;\r\n\t}\r\n\t\r\n\t\tspeak() {\r\n\t\t\tspeech.speak(this.name + '. Slider. Set to ' + this.currentValue);\r\n\t\t}\r\n\t\r\n\t\tincrease() {\r\n\t\t\tif (this.currentValue < this.maxValue) {\r\n\t\t\t\tthis.currentValue+=this.increaseBy;\r\n\t\t\t}\r\n\t\t\tif (this.currentValue>this.maxValue) this.currentValue=this.maxValue;\r\n\t\t\t\tspeech.speak(this.currentValue);\r\n\t\t}\r\n\t\r\n\t\tdecrease() {\r\n\t\t\tif (this.currentValue > this.minValue) {\r\n\t\t\t\tthis.currentValue-=this.increaseBy;\r\n\t\t\t}\r\n\t\t\tif (this.currentValue<this.minValue) this.currentValue=this.minValue;\r\n\t\t\t\tspeech.speak(this.currentValue);\r\n\t\t}\r\n\t\r\n\t\tselect() {\r\n\t\t\treturn this.id;\r\n\t\t}\r\n}\r\n\r\nclass EditItem extends MenuItem {\r\n\tconstructor(id, name, defaultText = '') {\r\n\t\tsuper();\r\n\t\t\tthis.id = id;\r\n\t\t\tthis.name = name;\r\n\t\t\tthis.text = defaultText;\r\n\t\t\tthis.type = MenuTypes.EDIT;\r\n\t}\r\n\t\r\n\t\tspeak() {\r\n\t\t\tspeech.speak(this.name + '. Editable. ' + (this.text == '' ? 'Nothing entered.' : 'Set to ' + this.text));\r\n\t\t}\r\n\t\r\n\t\taddChar(char) {\r\n\t\t\tthis.text += char;\r\n\t\t\t\tspeech.speak(char);\r\n\t\t}\r\n\t\r\n\t\tremoveChar() {\r\n\t\t\tthis.text = this.text.substring(0, this.text.length - 1);\r\n\t\t\t\tspeech.speak(this.text);\r\n\t\t}\r\n\t\r\n\t\tselect() {\r\n\t\t\treturn this.text;\r\n\t\t}\r\n}\r\nexport {MenuItem,AudioItem,SliderItem,SelectorItem,MenuTypes};\r\n","'use strict';\nimport \"babel-polyfill\";\r\nimport {utils} from './utilities';\nimport Hammer from 'hammerjs';\r\nimport {speech} from './tts';\r\nimport $ from 'jquery';\r\nimport {so} from './soundObject.js';\r\nimport {MenuTypes, MenuItem} from './menuItem';\r\nimport {KeyEvent} from './keycodes';\r\nimport {KeyboardInput} from './input';\r\n\r\nclass Menu {\r\n\tconstructor(name, menuData, music) {\n\t\tthis.fadeTime=0.8;\r\n\t\tthis.menuData = menuData;\n\t\tlet audio=name.split(\" \");\n\t\tconsole.log(\"length\",audio.length);\n\t\tif (audio.length<2) this.isAudio=true;\n\t\tif (audio.length>=2) this.isAudio=false;\r\n\t\t\t\t\t\tthis.silent=false;\n\t\t\t\t\t\tthis.prependAudio=\"\";\r\n\t\t\tthis.first=true;\r\n\t\t\tthis.cursor = 0;\r\n\t\t\tthis.name = name;\n\t\t\t\t\t\tlet dir=so.directory;\r\n\t\t\tso.directory=\"./sounds/\";\r\n\t\t\tthis.sndKeyChar = so.create('ui/keyChar');\r\n\t\t\tthis.sndKeyDelete = so.create('ui/keyDelete');\r\n\t\t\tthis.sndSliderLeft = so.create('ui/menuSliderLeft');\r\n\t\t\tthis.sndSliderRight = so.create('ui/menuSliderRight');\r\n\t\t\tthis.sndBoundary = so.create('ui/menuBoundary');\r\n\t\t\tthis.sndChoose = so.create('ui/menuChoose');\r\n\t\t\tthis.sndMove = so.create('ui/menuMove');\r\n\t\t\tthis.sndOpen = so.create('ui/menuOpen');\r\n\t\t\tthis.sndSelector = so.create('ui/menuSelector');\r\n\t\t\tthis.sndWrap = so.create('ui/menuWrap');\r\n\t\t\tso.directory=dir;\r\n\t\t\tthis.selectCallback = null;\r\n\t\t\tif (typeof music !== 'undefined') {\r\n\t\t\t\tthis.music = music;\r\n\t\t\t}\r\n\t\tconst id = document.getElementById('touchArea');\r\n\t\t this.hammer = new Hammer(id);\r\n\t}\r\n\t\r\n\t\tnextItem() {\r\n\t\t\tif (!this.first) {\r\n\t\t\t\tif (this.cursor < this.menuData.length - 1) {\r\n\t\t\t\t\tif (!this.silent) this.sndMove.play();\r\n\t\t\t\t\t\tthis.cursor++;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (!this.silent) this.sndWrap.play();\r\n\t\t\t\t\t\tthis.cursor=0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (!this.silent) this.sndMove.play();\r\n\t\t\t\t\tthis.first=false;\r\n\t\t\t}\r\n\t\t\tif (this.isAudio) {\r\n\t\t\t\tthis.sndName.stop();\r\n\t\t\t\t\tfor (let i=0;i<this.menuData.length;i++) {\r\n\t\t\t\t\t\tif (this.menuData[i].type==MenuTypes.AUDIO) this.menuData[i].snd.stop();\r\n\t\t\t\t\t}\r\n\t\t\t}\t\t\n\t\t\t\t\t\tthis.menuData[this.cursor].speak();\r\n\t\t}\r\n\t\r\n\t\tpreviousItem() {\r\n\t\t\tif (this.first) {\r\n\t\t\t\tthis.first=false;\r\n\t\t\t\t\tif (!this.silent) this.sndMove.play();\r\n\t\t\t}\r\n\t\t\tif (this.cursor > 0) {\r\n\t\t\t\tif (!this.silent) this.sndMove.play();\r\n\t\t\t\t\tthis.cursor--;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.cursor=this.menuData.length-1;\r\n\t\t\t\t\tif (!this.silent) this.sndWrap.play();\r\n\t\t\t\t\t\r\n\t\t\t}\r\n\t\t\tif (this.isAudio) {\r\n\t\t\t\tthis.sndName.stop();\r\n\t\t\t\t\tfor (let i in this.menuData) {\r\n\t\t\t\t\t\tif (this.menuData[i].type==MenuTypes.AUDIO) this.menuData[i].snd.stop();\r\n\t\t\t\t\t}\r\n\t\t\t}\t\t\r\n\t\t\tthis.menuData[this.cursor].speak();\n\t\t\tif (typeof this.moveCallback!==\"undefined\") {\n\t\t\t\tthis.moveCallback(this.menuData[this.cursor].id);\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\tincrease() {\r\n\t\t\tif (this.menuData[this.cursor].type == MenuTypes.SLIDER || this.menuData[this.cursor].type == MenuTypes.SELECTOR) {\r\n\t\t\t\tthis.menuData[this.cursor].increase();\r\n\t\t\t\t\tif (this.menuData[this.cursor].type == MenuTypes.SLIDER) {\r\n\t\t\t\t\t\tif (!this.silent) this.sndSliderRight.play();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (!this.silent) this.sndSelector.play();\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\tdecrease() {\r\n\t\t\tif (this.menuData[this.cursor].type == MenuTypes.SLIDER || this.menuData[this.cursor].type == MenuTypes.SELECTOR) {\r\n\t\t\t\tthis.menuData[this.cursor].decrease();\r\n\t\t\t\t\tif (this.menuData[this.cursor].type == MenuTypes.SLIDER) {\r\n\t\t\t\t\t\tif (!this.silent) this.sndSliderLeft.play();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (!this.silent) this.sndSelector.play();\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\tinsertCharacter(char) {\r\n\t\t\tif (this.menuData[this.cursor].type == MenuTypes.EDIT) {\r\n\t\t\t\tthis.menuData[this.cursor].addChar(String.fromCharCode(char));\r\n\t\t\t\t\tif (!this.silent) this.sndKeyChar.play();\n\t\t\t\t\treturn;\r\n\t\t\t}\n\t\t\t// Char navigation code\n\t\t\tfor (let i = this.cursor + 1; i < this.menuData.length; i++) {\n\t\t\t\tif (this.menuData[i].shortcut== String.fromCharCode(char).toLowerCase()) {\n\t\t\t\t\t\t\t\t\t\tthis.cursor = i;\n\t\t\t\t\t\t\t\t\t\tthis.select();\n\t\t\t\t\t\t\t\t\t\tconsole.log(\"meow\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (this.menuData[i].name.toLowerCase().substr(0, 1) == String.fromCharCode(char).toLowerCase()) {\n\t\t\t\t\tthis.cursor = i;\n\t\t\t\t\tthis.menuData[this.cursor].speak();\n\t\t\t\t\tthis.first = false;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (let i = 0; i < this.menuData.length; i++) {\n\t\t\t\tif (this.menuData[i].shortcut== String.fromCharCode(char).toLowerCase()) {\n\t\t\t\t\t\t\t\t\t\tthis.cursor = i;\n\t\t\t\t\t\t\t\t\t\tthis.select();\n\t\t\t\t\t\t\t\t\t\tconsole.log(\"meow\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (this.menuData[i].name.toLowerCase().substr(0, 1) == String.fromCharCode(char).toLowerCase()) {\n\t\t\t\t\tthis.cursor = i;\n\t\t\t\t\tthis.menuData[this.cursor].speak();\n\t\t\t\t\tthis.first = false;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\r\n\t\tremoveCharacter() {\r\n\t\t\tif (this.menuData[this.cursor].type == MenuTypes.EDIT) {\r\n\t\t\t\tthis.menuData[this.cursor].removeChar();\r\n\t\t\t\t\tif (!this.silent) this.sndKeyDelete.play();\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\thandleInput(event) {\r\n\t\t\tthis.insertCharacter(event.which);\r\n\t\t}\r\n\t\r\n\t\tdestroySounds() {\r\n\t\t\tthis.sndKeyChar.destroy();\r\n\t\t\t\tthis.sndKeyDelete.destroy();\r\n\t\t\t\tthis.sndSliderLeft.destroy();\r\n\t\t\t\tthis.sndSliderRight.destroy();\r\n\t\t\t\tif (this.isAudio) this.sndName.destroy();\r\n\t\t\t\tthis.sndBoundary.destroy();\r\n\t\t\t\tthis.sndChoose.destroy();\r\n\t\t\t\tthis.sndMove.destroy();\r\n\t\t\t\tthis.sndOpen.destroy();\r\n\t\t\t\tthis.sndSelector.destroy();\r\n\t\t\t\tthis.sndWrap.destroy();\r\n\t\t\t\tfor (let i=0;i<this.menuData.length;i++) {\r\n\t\t\t\t\tif (this.menuData[i].type==MenuTypes.AUDIO) this.menuData[i].snd.destroy();\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\tif (typeof this.music !== 'undefined') {\n\t\t\t\t\t\t\t\tthis.music.destroy();\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\t\r\n\t\tdestroy() {\r\n\t\t\t$(document).off('keydown');\r\n\t\t\t\t$(document).off('keypress');\r\n\t\t\t\t this.hammer.destroy();\n\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthis.destroySounds();\r\n\t\t\t\t\t\t}, this.fadeTime*1000);\r\n\t\t}\r\n\t\r\n\t\thandleKeys(event) {\r\n\t\t\tswitch (event.which) {\r\n\t\t\t\tcase KeyEvent.DOM_VK_RETURN:\r\n\t\t\t\t\t\t\t    this.select();\r\n\t\t\t\t\t\t\t\t    break;\r\n\t\t\t\tcase KeyEvent.DOM_VK_PAGE_UP:\r\n\t\t\t\t\t\t\t     this.music.volume += 0.03;\r\n\t\t\t\t\t\t\t\t     break;\r\n\t\t\t\tcase KeyEvent.DOM_VK_PAGE_DOWN:\r\n\t\t\t\t\t\t\t       this.music.volume -= 0.03;\r\n\t\t\t\t\t\t\t\t       break;\r\n\t\t\t\tcase KeyEvent.DOM_VK_BACK_SPACE:\r\n\t\t\t\t\t\t\t\tthis.removeCharacter();\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\tcase KeyEvent.DOM_VK_DOWN:\r\n\t\t\t\t\t\t\t  \r\n\t\t\t\t\t\t\t\t  this.nextItem();\r\n\t\t\t\t\t\t\t\t  break;\r\n\t\t\t\tcase KeyEvent.DOM_VK_UP:\r\n\t\t\t\t\t\t\tthis.previousItem();\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\tcase KeyEvent.DOM_VK_RIGHT:\r\n\t\t\t\t\t\t\t   \r\n\t\t\t\t\t\t\t\t   this.increase();\r\n\t\t\t\t\t\t\t\t   \r\n\t\t\t\t\t\t\t\t   break;\r\n\t\t\t\tcase KeyEvent.DOM_VK_LEFT:\r\n\t\t\t\t\t\t\t  \r\n\t\t\t\t\t\t\t\t  this.decrease();\r\n\t\t\t\t\t\t\t\t  \r\n\t\t\t\t\t\t\t\t  break;\r\n\t\t\t}\r\n\t\t}\r\n\tasync runSync() {\n\t\treturn new Promise((resolve,reject)=> {\n\t\t\t\tthis.run((s)=> {\n\t\t\t\t\t\tresolve(s.selected);\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t}\n\t\r\n\t\trun(callback) {\r\n\t\t\tif (typeof this.music === 'object') {\r\n\t\t\t\tthis.music.volume = 0.8;\r\n\t\t\t\t\tthis.music.loop = true;\n\t\t\t\t\t\t\t\t\t\tthis.music.play();\n\t\t\t\t\t\t\t\t\t\tspeech.ducker=this.music;\n\r\n\t\t\t} else if (typeof this.music === 'string') {\r\n\t\t\t\tthis.music = so.create(this.music,true);\r\n\t\t\t\t\tthis.music.volume = 0.8;\r\n\t\t\t\t\tthis.music.loop = true;\r\n\t\t\t\t\tthis.music.play();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tspeech.ducker=this.music;\r\n\t\t\t} else {\r\n\t\t\t}\r\n\t\t\tthis.selectCallback = callback;\r\n\t\t\t\tconst that = this;\r\n\t\t\t\t$(document).on('keypress', event => {\r\n\t\t\t\t\t\tthat.handleInput(event);\r\n\t\t\t\t\t\t});\r\n\t\t\t$(document).on('keydown', event => {\r\n\t\t\t\t\tthat.handleKeys(event);\r\n\t\t\t\t\t});\r\n\t\t\t\r\n\t\t\t  this.hammer.on(\"swipeleft\", function(event) { that.handleSwipe(0); });\r\n\t\t\t  this.hammer.on(\"swiperight\", function(event) { that.handleSwipe(1); });\r\n\t\t\t  this.hammer.on(\"panup\", function(event) { that.handleSwipe(3); });\r\n\t\t\t  this.hammer.on(\"pandown\", function(event) { that.handleSwipe(4); });\r\n\t\t\t  this.hammer.on(\"tap\", function(event) { that.handleSwipe(2); });\r\n\t\t\t \t\t\tif (this.isAudio) {\r\n\t\t\t\tthis.sndName=so.create(this.name);\r\n\t\t\t\t\tthis.sndName.play();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tspeech.speak(this.name);\r\n\t\t\t}\r\n\t\t\tif (!this.silent) this.sndOpen.play();\r\n\t\t}\r\n\t\r\n\t\thandleSwipe(action) {\r\n\t\t\tif (action == 3) {\r\n\t\t\t\tthis.decrease();\r\n\t\t\t}\r\n\t\t\tif (action == 4) {\r\n\t\t\t\tthis.increase();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t\tif (action == 0) {\r\n\t\t\t\t\tthis.previousItem();\r\n\t\t\t\t}\r\n\t\t\tif (action == 1) {\r\n\t\t\t\tthis.nextItem();\r\n\t\t\t}\r\n\t\t\tif (action == 2) {\r\n\t\t\t\tthis.select();\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\tselect() {\n\t\t\t//select function\r\n\t\t\tconst selected = this.menuData[this.cursor].id;\r\n\t\t\t\tconst items = [];\r\n\t\t\t\tfor (let i = 0; i < this.menuData.length; i++) {\r\n\t\t\t\t\tlet addItem = null;\r\n\t\t\t\t\t\tif (this.menuData[i].type == MenuTypes.SLIDER) {\r\n\t\t\t\t\t\t\taddItem = {\r\n\t\t\t\t\t\t\t\tid: this.menuData[i].id,\r\n\t\t\t\t\t\t\t\t\tvalue: this.menuData[i].currentValue,\r\n\t\t\t\t\t\t\t\t\t//name: this.menuData[i].options[this.menuData[i].currentValue]\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\tif (this.menuData[i].type == MenuTypes.EDIT) {\r\n\t\t\t\t\t\taddItem = {\r\n\t\t\t\t\t\t\tid: this.menuData[i].id,\r\n\t\t\t\t\t\t\t\tvalue: this.menuData[i].text\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.menuData[i].type == MenuTypes.SELECTOR) {\r\n\t\t\t\t\t\taddItem = {\r\n\t\t\t\t\t\t\tid: this.menuData[i].id,\r\n\t\t\t\t\t\t\t\tvalue: this.menuData[i].currentOption,\r\n\t\t\t\t\t\t\t\tname: this.menuData[i].options[this.menuData[i].currentOption]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\titems.push(addItem);\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\tconst toReturn = {\r\n\t\t\t\t\tselected,\r\n\t\t\t\t\t\tcursor: this.cursor,\r\n\t\t\t\t\t\titems\r\n\t\t\t\t};\r\n\t\t\tif (!this.silent) this.sndChoose.play();\r\n\t\t\t\t$(document).off('keydown');\r\n\t\t\t\t$(document).off('keypress');\n\t\t\t\tif (this.isAudio) {\n\t\t\t\t\tthis.sndName.stop();\n\t\t\t\t\t\tfor (let i=0;i<this.menuData.length;i++) {\n\t\t\t\t\t\t\tif (this.menuData[i].type==MenuTypes.AUDIO) this.menuData[i].snd.stop();\n\t\t\t\t\t\t}\n\t\t\t\t}\t\t\n\t\t\t\t\tif (!this.silent) this.musicDuration=this.fadeTime*1000;\n\t\t\t\t\tif (typeof this.music===\"undefined\" || this.silent) this.musicDuration=0;\n\t\t\t\t\tconsole.log(\"duration \"+this.musicDuration);\r\n\t\t\tconst that = this;\n\t\t\t\tif (typeof this.music!==\"undefined\") {\n\t\t\t\t\tthis.music.sound.fade(0,this.fadeTime);\n\t\t\t\t}\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthat.selectCallback(toReturn);\r\n\t\t\t\t\t\t}, this.musicDuration);\r\n\t\t}\r\n}\r\nexport {Menu};\r\n","import { utils } from './utilities';\nimport \"babel-polyfill\";\nimport { speech } from './tts';\nvar fs = require('fs');\nimport { so } from './soundObject';\nclass NumberSpeaker {\n\tconstructor() {\n\t\tthis.ntw = require('number-words');\n\t\tthis.word_list = [];\n\t\tthis.has_number = false;\n\t\tthis.current_index = 0;\n\t\tthis.prepend = \"\";\n\t\tthis.append = \"\";\n\t\tthis.include_and = false;\n\t\tthis.sound = null;\n\t}\n\n\tspeak(the_number) {\n\t\tthe_number = Math.floor(the_number);\n\t\t// Reset our internal data.\n\n\t\tthis.word_list = [];\n\t\tthis.has_number = false;\n\t\tthis.current_index = 0;\n\t\tif (this.sound != null) this.sound.destroy();\n\t\t// Check for invalid range.\n\t\tif (this.the_number < -999999999 || this.the_number > 999999999) {\n\t\t\treturn -1;\n\t\t}\n\t\t// Convert our number to English words, and then split it up by space.\n\t\tlet english_words = this.ntw.convert(Math.abs(the_number));\n\t\tif (the_number == 0) english_words = \"zero\";\n\t\tconsole.log(english_words);\n\n\t\tif (english_words == \"\") {\n\t\t\treturn -1;\n\t\t}\n\t\tthis.word_list = english_words.split(\" \");\n\t\tif (the_number < 0) this.word_list.unshift(\"minus\");\n\t\tthis.has_number = true;\n\t\tif (!this.and) {\n\n\t\t\tfor (let i = 0; i < this.word_list.length; i++) {\n\t\t\t\tif (this.word_list[i] == \"and\") {\n\t\t\t\t\tthis.word_list.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// We call \"speak_next\" so that the first number is spoken immediately.\n\t\tif (this.speak_next() == -1) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tspeak_next() {\n\t\t// First we do some checks to see if the number is still being spoken.\n\t\tif (this.has_number == false) {\n\t\t\tif (this.sound != null) {\n\t\t\t\tconsole.log(\"meh\",this.sound.sound.progress)\n\t\t\t\tif (this.sound.playing == false && this.sound.loaded) {\n\t\t\t\t\tthis.sound.destroy();\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn -1;\n\t\t}\n\t\tif (this.sound != null) {\n\t\t\tif (this.sound.playing == true || this.sound.sound.state() == \"loading\") {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t}\n\t\t// Now we go through the remaining words, looking for the best matching filename.\n\t\tlet look_until = this.word_list.length;\n\t\tlet assembled_filename = this.prepend;\n\t\tlet count = 0;\n\t\twhile (true) {\n\t\t\tfor (let i = this.current_index; i < look_until; i++) {\n\t\t\t\tif (i == look_until - 1) {\n\t\t\t\t\tassembled_filename += this.word_list[i] + this.append;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tassembled_filename += this.word_list[i] + \"_\";\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Now we have a filename to test, let's see if it loads.\n\t\t\tconsole.log(assembled_filename);\n\t\t\tif (!fs.existsSync(__dirname + \"/sounds/\" + assembled_filename + so.extension)) {\n\t\t\t\t// It didn't, so we remove the last entry from our current search.\n\t\t\t\tlook_until -= 1;\n\t\t\t\tif (look_until == this.current_index) {\n\t\t\t\t\t// No file matched the smallest possible search, so we get out.\n\t\t\t\t\tthis.word_list = [];\n\t\t\t\t\tthis.has_number = false;\n\t\t\t\t\tthis.current_index = 0;\n\t\t\t\t\tif (this.sound != null) this.sound.destroy();\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\t// There are still some possible alternatives left, keep searching.\n\t\t\t\tassembled_filename = this.prepend;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// We found a file, so we tell the next search to begin at the point where we stopped.\n\t\t\t\tconsole.log(assembled_filename);\n\t\t\t\tthis.sound = so.create(assembled_filename);\n\t\t\t\tthis.current_index = look_until;\n\t\t\t\tthis.sound.play();\n\t\t\t\tthis.sound.sound.once(\"end\", () => {\n\t\t\t\t\tthis.speak_next();\n\t\t\t\t});\n\n\t\t\t\tif (this.current_index == this.word_list.length) {\n\n\t\t\t\t\t// We've reached the end of our word list, so we don't search anymore.\n\t\t\t\t\tthis.word_list = [];\n\t\t\t\t\tthis.has_number = false;\n\t\t\t\t\tthis.current_index = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn 1;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tstop() {\n\t\t// Reset our internal data.\n\t\tthis.word_list = [];\n\t\tthis.has_number = false;\n\t\tthis.current_index = 0;\n\t\tif (this.sound != null) {\n\t\t\tthis.sound.destroy();\n\t\t}\n\t}\n\n\tasync speakWait(the_number) {\n\t\t// This is just a simple wrapper around \"speak\" and \"speak_next\".\n\t\tif (this.speak(the_number) == -1)\n\t\t\treturn -1;\n\t\tlet result = 0;\n\t\twhile (true) {\n\t\t\tawait utils.sleep(16);\n\t\t\tresult = this.speak_next();\n\t\t\tif (result == -1) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif (result == 0)\n\t\t\t\treturn 0;\n\t\t}\n\t\treturn -1;\n\t}\n}\nexport { NumberSpeaker }","function Timer(callbacks, step) {\r\n\tlet last = 0;\r\n\tlet active = false;\r\n\tlet acc = 0;\r\n\tlet tick = 0;\r\n\tlet inc = step || 1 / 120;\r\n\tlet frameId;\r\n\r\n\tfunction onFrame(time) {\r\n\t\tif (last !== null) {\r\n\t\t\tacc += (time - last) / 1000;\r\n\t\t\twhile (acc > inc) {\r\n\t\t\t\tcallbacks.update(inc, tick);\r\n\t\t\t\ttick += 1;\r\n\t\t\t\tacc -= inc;\r\n\t\t\t}\r\n\t\t}\r\n\t\tlast = time;\r\n\t\tcallbacks.render();\r\n\t\tif (active) {\r\n\t\t\tframeId = requestAnimationFrame(onFrame);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction start() {\r\n\t\tlast = null;\r\n\t\tactive = true;\r\n\t\tframeId = requestAnimationFrame(onFrame);\r\n\t}\r\n\r\n\tfunction stop() {\r\n\t\tactive = false;\r\n\t\tcancelAnimationFrame(frameId);\r\n\t}\r\n\tfunction change(value) {\r\n\t\tinc = value || 1 / 60;\r\n\t\tacc = inc;\r\n\t\ttick = 0;\r\n\t\tstop();\r\n\t\tstart();\r\n\t}\r\n\treturn {\r\n\t\tstart,\r\n\t\t\tstop,\r\n\t\t\tchange\r\n\t};\r\n}\r\n\r\nmodule.exports = Timer;\r\n","import {speech} from './tts';\r\nimport {sl} from './main';\r\nimport {AudioItem} from './menuItem';\r\n\r\nimport {utils} from './utilities';\r\nimport {speak,setup,lang,vo} from './main';\r\n\r\nimport Timer from './timer';\r\nimport {ScrollingText} from './scrollingText';\r\nimport {KeyboardInput} from './input.js';\r\nimport {KeyEvent} from './keycodes.js';\r\nimport {so} from './soundObject';\r\nimport {Menu} from './menu';\r\nclass Game {\r\n\tconstructor() {\r\n\t\tthis.lives=0;\r\n\t\tthis.score=0;\r\n\t\tthis.level=0;\r\n\t\tthis.playing=false;\r\n\t\tthis.lastscore=0;\r\n\t\tthis.lastdiff=0;\r\n\t\tthis.lastlevel=0;\r\n\t\t\t\tthis.safe=so.create(\"g_save\");\r\n\t\t\t\t}\r\nstart(md) {\r\n\tthis.round=0;\r\n\tthis.cats=0;\r\n\t\tthis.rsc=0;\r\n\tthis.oldround=0;\r\n\tthis.csnd=8;\r\n\tthis.alive=false;\r\n\t\tthis.catrev=so.create(\"g_catreverb\");\r\n\tthis.lives=0;\r\n\tthis.catsmirk=so.create(\"g_catsmirk\");\r\nthis.maxround=3;\r\nthis.alive=true;\r\nthis.rsc=0;\r\nthis.score=0;\r\nthis.round=0;\r\nthis.playing=true;\r\nthis.mode=md;\r\nthis.gameLoop();\r\n\t\t}\r\nasync speakstats() {\r\n\t\tif (this.score>=0) await speak(\"yfs\");\r\n\tif (this.score<0) await speak(\"nyfs\");\r\n\t\tawait vo.speakWait(this.score);\r\n\tawait speak(\"points\");\r\n\t}\r\n\tasync gameLoop() {\r\n\t\tawait utils.sleep(16);\r\n\t\tthis.cats=1;\r\n\t\tthis.round++;\r\n\t\tthis.rsc=0;\r\n\t\tif (this.round<=this.maxround) {\r\n\t\t\tthis.alive=true;\r\n\t\t}\r\n\t\telse {\r\n\t\t\t\t\t\tthis.alive=false;\r\n\t\t\t\t\t\t\tawait this.speakstats();\r\n\t\t\t\t\t\t\tsetup();\r\nreturn;\r\n\t\t}\r\n\t\twhile(this.alive) {\r\n\t\t\tawait speak(\"round\");\r\n\t\t\tawait vo.speakWait(this.round);\r\n\t\t\tthis.cats=1;\r\n\t\t\tlet opt=\"\";\r\n\t\t\twhile(true) {\r\n\t\t\t\tthis.cats++;\r\n\t\t\t\tif (this.cats<1) this.cats=2;\r\n\t\t\t\tthis.rcat=utils.randomInt(1,this.cats);\r\n\t\t\t\tawait speak(\"total\");\r\n\t\t\t\tawait vo.speakWait(this.cats);\r\n\t\t\t\tconst items=[];\r\n\t\t\t\tfor (let i=1;i<=this.cats;i++) {\r\n\t\t\t\t\titems.push(new AudioItem(i,\"g_cat_\"+utils.randomInt(1,this.csnd)));\r\n\t\t\t\t}\r\n\t\t\t\tif (this.rsc>0) \t\t\t\titems.push(new AudioItem(\"esc\",sl+\"next\"));\r\n\t\t\t\tlet cam=new Menu(sl+\"choose\",items);\r\n\t\t\t\tcam.silent=true;\r\n\t\t\t\topt=await cam.runSync();\r\n\t\t\t\tif (opt==\"esc\") {\r\nthis.safe.play();\r\n\t\t\t\t\tawait utils.sleep(800);\r\n\t\t\t\t\tawait speak(\"saved\");\r\n\t\t\t\t\tawait vo.speakWait(this.rsc);\r\n\t\t\t\t\tthis.score+=this.rsc;\r\n\t\t\t\t\tawait speak(\"points\");\r\n\t\t\t\t\tthis.gameLoop();\r\nbreak;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tawait this.catrev.playSync();\t\t\t\t\t\r\n\t\t\t\t\tlet chosencat=Number(opt);\r\n\t\t\t\t\tif (chosencat!=this.rcat) {\r\n\t\t\t\t\t\tconsole.log(this.mode);\r\n\t\t\t\t\t\tif (this.mode==1 || (this.mode==2 && this.lives<=0)) {\r\nlet bad=so.create(\"g_bad\"+utils.randomInt(1,2));\r\nbad.play();\r\nawait utils.sleep(800);\r\nawait speak(\"curse\"+utils.randomInt(1,5));\r\nawait this.catsmirk.playSync();\r\nif (this.rsc>0) {\r\n\tawait speak(\"lose\");\r\n\tawait vo.speakWait(this.rsc);\r\n\tawait speak(\"points\");\r\n}\r\nthis.rsc=0;\r\nthis.alive=false;\r\nthis.gameLoop();\r\nbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tthis.lives--;\r\n\t\t\t\t\t\t\tthis.cats--;\r\n\t\t\t\t\t\t\tlet llife=so.create(\"g_llife\");\r\n\t\t\t\t\t\t\tllife.play();\r\n\t\t\t\t\t\t\tawait utils.sleep(1100);\r\n\t\t\t\t\t\t\tawait speak(\"lost\"+utils.randomInt(1,3));\r\n\t\t\t\t\t\t\tawait this.catsmirk.playSync();\r\n\t\t\t\t\t\t\tawait speak(\"lives\");\r\n\t\t\t\t\t\t\tawait vo.speakWait(this.lives);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis.rsc+=this.cats*2;\r\n\t\t\t\t\t\tlet good=so.create(\"g_good\"+utils.randomInt(1,4));\r\ngood.play();\r\n\t\t\t\t\t\tthis.lives++;\r\n\t\t\t\t\t\tawait utils.sleep(800);\r\n\t\t\t\t\t\tif (this.cats%4==0) {\r\n\t\t\t\t\t\t\tthis.maxround++;\r\n\t\t\t\t\t\tlet extend=so.create(\"g_extend\");\r\n\t\t\t\t\t\textend.play();\r\nawait utils.sleep(350);\r\n\t\t\t\t\t\tawait speak(\"extend\");\r\n\t\t\t\t\t\tthis.rsc+=this.cats*5;\r\n\t\t\t\t\t\tthis.lives+=2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tawait speak(\"yay\"+utils.randomInt(1,5));\r\n\t\t\t\t\t\tawait utils.sleep(utils.randomInt(300,600));\r\n\t\t\t\t\t\tawait speak(\"toget\");\r\n\t\t\t\t\t\tawait vo.speakWait(this.rsc);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.alive=false;\r\n\t\t\tawait utils.sleep(5);\r\n\t\t}\r\n\t\r\n\t}\r\n}\r\nexport {Game}","export var gameID=\"bombercats\";\r\nexport var lang = 2;\r\nimport {AudioItem} from './menuItem';\r\nimport {Menu} from './menu';\r\nimport {so} from './soundObject';\r\nimport {speech} from './tts';\r\nimport {NumberSpeaker} from './numberSpeaker';\r\nimport {Game} from './game';\r\nexport var version=\"1.0\";\r\nexport var version2=\"\";\r\n\r\n\r\nexport var ttsVoice;\r\nexport var ttsRate=1;\r\nimport $ from 'jquery';\r\ndocument.addEventListener('DOMContentLoaded', setup);\r\nexport var sl=\"speaker_\"+lang+\"_\"\r\nexport async function speak(what) {\r\n\tlet snd=so.create(sl+what);\r\n\tawait snd.playSync();\r\n\tsnd.destroy();\r\n}\r\nexport var vo=new NumberSpeaker();\r\nvo.prepend=\"speaker_\"+lang+\"_num_\";\r\nvo.and=false;\r\nif (lang==2) vo.and=true;\r\nexport async function setup() {\r\ndocument.getElementById(\"app\").focus();\r\n\t//the below is an example of a new version notifier. The version2 variable can be used and compared inside a menu or wherever, and would contain the new version of your game based on what your server returns.\r\n\tlet prom=new Promise((resolve,reject)=> {\r\n\t\t\ttry {\r\n\t\t\tfetch('http://oriolgomez.com/versions.php?gameVersionRequest='+gameID)\r\n\t\t\t.then(event => event.text()) //convert http response into text\r\n\t\t\t.then(data => {\r\n\t\t\t\t\tversion2=data;\r\n\t\t\t\t\tresolve(data); //resolve promise let go.\r\n\t\t\t\t\t});\r\n\t\t\t} catch {\r\n\t\t\tconsole.log(\"can't get version.\");\r\n\t\t\t}\r\n\t\t\t});\r\n\tconsole.log(\"Success!\");\r\n\tlet items=[];\r\n\titems.push(new AudioItem(\"s\",sl+\"menu_startgame\"));\r\n\t\titems.push(new AudioItem(\"a\",sl+\"menu_startcoward\"));\r\n\tlet music=so.create(\"menu_music\");\r\n\tmusic.loop=true;\r\n\tmusic.volume=0.5;\r\n\tmusic.play();\r\n\t\r\n\t\tlet mainMenu=new Menu(sl+\"menu_intro\",items);\r\n\t\tlet o=await mainMenu.runSync();\r\n\t\tmusic.sound.fade(music.volume,0,800);\r\n\t\tmusic.sound.once(\"fade\",()=> {\r\n\t\t\tmusic.destroy();\r\n\t\t\tif (o==\"s\") {\r\n\t\t\t\tstartGame(1);\r\n\t\t\t}\r\n\t\t\tif (o==\"a\") {\r\n\t\t\t\tstartGame(2);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t});\r\n\t\t}\r\nfunction startGame(md) {\r\n\tlet game=new Game();\r\n\tgame.start(md);\r\n}\r\n"]}